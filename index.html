<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Material Calcs</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#6750A4">
    
    <link href="https://cdn.jsdelivr.net/npm/beercss@3.5.1/dist/cdn/beer.min.css" rel="stylesheet">
    <script type="module" src="https://cdn.jsdelivr.net/npm/beercss@3.5.1/dist/cdn/beer.min.js"></script>
    <script src="https://www.desmos.com/api/v1.11/calculator.js?apiKey=dcb31709b452b1cf9dc26972add0fda6"></script>

    <style>
        :root { --primary: #6750A4; --round-xl: 28px; }
        body { background-color: #fbf8fd; transition: background 0.4s ease; }
        .glass { background: rgba(255,255,255,0.7); backdrop-filter: blur(10px); border-radius: var(--round-xl); }
        #calculator { height: 400px; border-radius: var(--round-xl); overflow: hidden; border: 1px solid #e0e0e0; }
        .keypad { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
        button { border-radius: 16px; transition: 0.2s; }
        button:active { transform: scale(0.92); border-radius: 30px; }
        .op { background: var(--primary) !important; color: white !important; border-radius: 30px; }
    </style>
</head>
<body class="light">

    <header class="p2 surface-container">
        <nav>
            <i class="extra">calculate</i>
            <h4 class="max center-align">Material Calcs</h4>
            <button class="circle transparent" onclick="toggleTheme()">
                <i id="t-icon">dark_mode</i>
            </button>
        </nav>
    </header>

    <main class="responsive p2">
        <div class="grid">
            <div class="s12 m8">
                <div class="field large prefix round extra fill margin">
                    <i>terminal</i>
                    <input type="text" id="omni" placeholder="y = x^2 or 100 USD to EUR" oninput="handleInput(this.value)">
                </div>
                <div id="calculator"></div>
            </div>

            <div class="s12 m4">
                <article class="glass p2 mb2">
                    <div class="row"><i>payments</i><h6>Currency</h6></div>
                    <div class="field label border round extra">
                        <input type="number" id="amt" value="1" oninput="convert()">
                        <label>Amount</label>
                    </div>
                    <h3 id="cur-res" class="center-align bold primary-text">€0.94</h3>
                </article>

                <article class="glass p2">
                    <div class="keypad">
                        <button class="fill" onclick="press('7')">7</button>
                        <button class="fill" onclick="press('8')">8</button>
                        <button class="fill" onclick="press('9')">9</button>
                        <button class="op" onclick="press('/')">÷</button>
                        <button class="fill" onclick="press('1')">1</button>
                        <button class="fill" onclick="press('2')">2</button>
                        <button class="fill" onclick="press('3')">3</button>
                        <button class="op" onclick="solve()">=</button>
                    </div>
                </article>
            </div>
        </div>
    </main>

    <script>
        const calc = Desmos.GraphingCalculator(document.getElementById('calculator'), {expressions:false, settingsMenu:false});
        function vibrate() { if(navigator.vibrate) navigator.vibrate(20); }
        
        function handleInput(v) {
            if(v.includes('y') || v.includes('x')) {
                calc.setExpression({id:'q', latex: v});
                document.body.style.setProperty('--primary', '#6750A4');
            }
        }

        function toggleTheme() {
            vibrate();
            const isDark = ui('theme') == 'dark';
            ui('theme', isDark ? 'light' : 'dark');
            document.getElementById('t-icon').innerText = isDark ? 'dark_mode' : 'light_mode';
        }

        function convert() {
            const a = document.getElementById('amt').value;
            document.getElementById('cur-res').innerText = '€' + (a * 0.94).toFixed(2);
        }

        function press(v) { vibrate(); document.getElementById('omni').value += v; }
        function solve() { vibrate(); try { document.getElementById('omni').value = eval(document.getElementById('omni').value); } catch(e) {} }
    </script>
</body>
</html>
